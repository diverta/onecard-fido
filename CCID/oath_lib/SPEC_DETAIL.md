# 詳細仕様

最終更新日：2022/11/22

## 概要
OATHに関する仕様の詳細について記載しています。

## コマンド仕様

以下のコマンドについてのリクエスト／レスポンスに関する仕様を記載しています。
- 認証器にクレデンシャルを個別登録

### 認証器にクレデンシャルを個別登録

<b>リクエストヘッダー</b>

|#|INS|P1|P2|名称|説明|
|:---:|:---:|:---:|:---:|:---|:---|
|1|`0x01`|`0x00`|`0x00`|`OATH_INS_PUT`|認証器にクレデンシャルを個別登録|

<b>リクエストデータ</b><br>
TLV形式で構成されています。

|#|Offset|桁数|名称または値|説明|
|:---:|:---:|:---:|:---|:---|
|1|0|1|`OATH_TAG_NAME`（`0x71`）|項目＝アカウント|
|2|1|1|account name size|アカウント名の長さ|
|3|2|64| account name|アカウント名|
|4|66|1|`OATH_TAG_KEY`（`0x73`）|項目＝Secret（暗号）|
|5|67|1|secret size|Secretの長さ|
|6|68|66|secret|Secret|
|7|134|1|`OATH_TAG_PROPERTY`（`0x78`）|項目＝オプション属性|
|8|135|1|property size|オプション属性の長さ|
|9|136|1|property|オプション属性|
|10|137|1|`OATH_TAG_COUNTER`（`0x7A`）|項目＝カウンター|
|11|138|1|counter size|カウンターの長さ|
|12|139|4|counter|カウンター|

<b>レスポンスステータスワード</b>

|#|値|名称|説明|
|:---:|:---:|:---|:---|
|1|`0x9000`|`SW_NO_ERROR`|正常終了|
|2|上記以外|-|処理失敗|
